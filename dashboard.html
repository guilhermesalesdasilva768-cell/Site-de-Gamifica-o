<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0, minimum-scale=0.2">
    <title>Grow System - Dashboard</title>
    <style>
        :root {
            --bg-gradient-start: #00C6FF;
            --bg-gradient-end: #0072FF;
            --sidebar-bg: #181c2f;
            --sidebar-active: #2563eb22;
            --card-bg: #0D1E31;
            --card-header-bg: #0A0F24;
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: #FFFFFF;
            --text-secondary: #B3B9C5;
            --medal-gold: #FFB800;
            --medal-silver: #B0B9C6;
            --medal-bronze: #D07C3D;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(180deg, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
        }
        /* --- SIDEBAR --- */
       .sidebar {
    width: 250px;
    background: var(--sidebar-bg);
    color: #fff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    position: fixed;
    left: 0;
    top: 0;
    z-index: 100;
    box-shadow: 2px 0 12px rgba(0,0,0,0.07);

    /* üîπ Permite rolagem quando passar da tela */
    overflow-y: auto;
}

        .sidebar .logo {
    font-weight: bold;
    font-size: 2rem;
    padding: 36px 0 30px 0;
    text-align: center;
    color: var(--medal-gold);
    background: linear-gradient(90deg, #181c2f 60%, #2563eb22 100%);
    border-bottom: 1px solid var(--border-color);
}
       .sidebar-nav {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-top: 40px;
    padding-bottom: 20px;
}

     .sidebar-nav {
  flex-direction: column;
  gap: 16px;
  margin-top: 40px;
  overflow-y: scroll !important;
  padding-bottom: 20px;
  /* rolagem estilizada opcional */
  scrollbar-width: thin;
  scrollbar-color: #2563eb22 #181c2f;
}
.sidebar-nav::-webkit-scrollbar {
  width: 8px;
  background: #181c2f;
}
.sidebar-nav::-webkit-scrollbar-thumb {
  background: #2563eb22;
  border-radius: 7px;
}
.sidebar-nav {
  scrollbar-width: thin;
  scrollbar-color: #2563eb22 #181c2f;
}
        .sidebar-nav .nav-icon {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 16px 44px;
            cursor: pointer;
            font-size: 1.13rem;
            border-radius: 12px 0 0 12px;
            border-left: 5px solid transparent;
            transition: background 0.2s, border-color 0.2s;
        }
        .sidebar-nav .nav-icon.active, .sidebar-nav .nav-icon:hover {
            background: var(--sidebar-active);
            border-left: 5px solid var(--medal-gold);
        }
        .sidebar-nav .nav-icon i {
            font-size: 1.5rem;
        }
        /* --- FIM SIDEBAR --- */

    .main-content {
    margin-left: 250px;
    padding: 0 32px 32px 32px;
    width: calc(100vw - 250px);
    height: 100vh;
    overflow-y: auto;
    overflow-x: hidden;
    box-sizing: border-box;
    scrollbar-width: thin;
    scrollbar-color: var(--medal-gold) var(--card-bg);
}

/* Estilo personalizado da barra de rolagem para navegadores Webkit */
.main-content::-webkit-scrollbar {
    width: 8px;
}

.main-content::-webkit-scrollbar-track {
    background: var(--card-bg);
    border-radius: 4px;
}

.main-content::-webkit-scrollbar-thumb {
    background: var(--medal-gold);
    border-radius: 4px;
    opacity: 0.7;
}

.main-content::-webkit-scrollbar-thumb:hover {
    background: #ffce45;
    opacity: 1;
}
        .topbar {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 32px 0 18px 0;
            gap: 16px;
        }
       .topbar-user {
  display: flex;
  align-items: center;
  gap: 18px;
  background: var(--card-bg);
  border-radius: 32px;
  box-shadow: 0 4px 18px rgba(0,0,0,0.11);
  padding: 13px 28px 13px 13px;
}

.avatar-lg {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  overflow: hidden;
  border: 3px solid var(--medal-gold);
  display: flex;
  align-items: center;
  justify-content: center;
  background: #e5e7eb;
}

.avatar-lg img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}

.topbar-info {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
}

.topbar-info h2 {
  margin: 0;
  font-size: 1.30rem;
  font-weight: bold;
  color: var(--text-primary);
}

.xp-badge {
  display: flex;
  align-items: center;
  background: var(--medal-gold);
  color: var(--card-header-bg);
  padding: 7px 16px;
  border-radius: 16px;
  font-size: 1.08rem;
  font-weight: bold;
  box-shadow: 0 2px 9px rgba(0,0,0,0.10);
  margin-top: 2px;
}
        /* --- HOME/ DASHBOARD --- */
        .home-section {
            display: block;
            background: none;
            box-shadow: none;
            border-radius: 0;
            padding: 0;
            margin-bottom: 0;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-top: 32px;
        }
        @media (max-width: 900px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        .dashboard-card {
            background: var(--card-header-bg);
            border-radius: 18px;
            box-shadow: 0 4px 24px rgba(255, 255, 255, 0.08);
            padding: 32px 24px;
            color: var(--text-primary);
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .dashboard-card h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            font-weight: bold;
            text-align: center;
        }
        .divider {
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--medal-gold), transparent);
            margin: 0 auto 16px auto;
            border-radius: 3px;
        }
        .user-stats {
            display: flex;
            justify-content: space-around;
            align-items: center;
            text-align: center;
            margin-top: 15px;
            gap: 32px;
            width: 100%;
        }
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 7px;
        }
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--medal-gold);
        }
        .stat-label {
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        .dashboard-card ul {
            list-style: none;
            padding: 0;
            margin: 20px 0 0 0;
            width: 100%;
        }
        .dashboard-card ul li {
            margin-bottom: 8px;
            font-size: 1.12rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .quiz-highlight {
            text-align: center;
        }
        .cta-button {
            background: var(--medal-gold);
            color: var(--card-header-bg);
            font-weight: bold;
            padding: 12px 28px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            transition: background 0.2s;
            font-size: 1.05rem;
            margin-top: 16px;
            display: inline-block;
        }
        .cta-button:hover {
            background: #ffce45;
        }
        .fact-of-day {
            text-align: center;
        }
        /* --- FIM DASHBOARD --- */

        /* --- Learn Section --- */
        .learn-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            text-align: left;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        .learn-section .section-title {
            text-align: center;
        }
        .learn-topic {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            background-color: var(--card-header-bg);
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .learn-topic:hover {
            background-color: rgba(10, 15, 36, 0.8);
        }
        .topic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .topic-arrow {
            transition: transform 0.3s;
        }
        .topic-arrow.rotate {
            transform: rotate(90deg);
        }
        .topic-content {
            display: none;
            margin-top: 20px;
            font-size: 1.1rem;
            line-height: 1.6;
            color: var(--text-secondary);
            max-width: 800px;
        }
        .topic-content.show {
            display: block;
        }
        .topic-content h4 {
            color: var(--medal-gold);
            margin-bottom: 10px;
        }
        .topic-content ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        .topic-content li {
            margin-bottom: 10px;
        }
        .learn-quiz-button {
            margin-top: 20px;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            background-color: var(--medal-gold);
            color: var(--card-header-bg);
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }
        .learn-quiz-button:hover {
            background-color: #0d1012;
            transform: translateY(-3px);
            box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.4);
        }

        /* --- Ponto Section --- */
        .ponto-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        .history-table-container {
            max-width: 900px;
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin: 0 auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .history-table-container h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-align: center;
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .history-table th, .history-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--text-primary);
        }
        .history-table th {
            background-color: var(--card-header-bg);
            font-weight: bold;
            color: var(--text-secondary);
        }
        .history-table tbody tr:last-child td {
            border-bottom: none;
        }
        .history-table .no-data {
            text-align: center;
            color: var(--medal-gold);
            font-weight: bold;
        }

        /* --- Ranking Section --- */
        .ranking-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .ranking-table th, .ranking-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        .ranking-table th {
            background-color: var(--card-header-bg);
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        .ranking-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .user-cell {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .medal {
            width: 25px;
            height: 25px;
            margin-left: 10px;
        }
        .position-1 {
            background-color: rgba(255, 184, 0, 0.1);
        }
        .position-2 {
            background-color: rgba(176, 185, 198, 0.1);
        }
        .position-3 {
            background-color: rgba(208, 124, 61, 0.1);
        }
        .xp-cell {
            font-weight: bold;
        }
        .xp-coins {
            color: var(--medal-gold);
        }

        footer {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 40px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Responsivo para sidebar */
        @media (max-width: 900px) {
            .main-content {
                margin-left: 0;
                padding: 0 8px 32px 8px;
            }
            .sidebar {
                width: 100%;
                min-height: unset;
                flex-direction: row;
                height: 60px;
                position: static;
            }
            .sidebar .logo {
                display: none;
            }
            .sidebar-nav {
                flex-direction: row;
                margin-top: 0;
                gap: 0;
            }
            .sidebar-nav .nav-icon {
                flex: 1;
                justify-content: center;
                padding: 0 0 0 0;
                border-left: none;
                border-bottom: 5px solid transparent;
            }
            .sidebar-nav .nav-icon.active, .sidebar-nav .nav-icon:hover {
                border-left: none;
                border-bottom: 5px solid var(--medal-gold);
            }
        }

        .home-section {
  background: none;
  box-shadow: none;
  border-radius: 0;
  padding: 0;
  margin-bottom: 0;
}
.home-container {
  max-width: 100%;
  margin: 0 auto;
  padding: 0 0 32px 0;
}
.home-welcome-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  background: var(--card-header-bg);
  border-radius: 28px;
  padding: 42px 44px 42px 44px;
  margin-bottom: 32px;
  box-shadow: 0 4px 32px #00000033;
  gap: 48px;
}
@media (max-width: 1100px) {
  .home-welcome-row { flex-direction: column; gap: 32px; text-align: center; align-items: center; }
}
.home-welcome-main {
  flex: 2;
}
.home-welcome-title {
  font-size: 2.3rem;
  font-weight: 800;
  color: var(--text-primary);
  margin: 0 0 12px 0;
  line-height: 1.1;
}
.home-welcome-title span {
  color: var(--medal-gold);
}
.home-welcome-desc {
  color: var(--text-secondary);
  font-size: 1.13rem;
  margin: 0 0 30px 0;
}
.home-welcome-actions {
  display: flex;
  gap: 16px;
  margin-top: 15px;
  flex-wrap: wrap;
}
.home-btn-primary {
  background: #43e68b;
  color: #14213d;
  font-weight: bold;
  padding: 13px 28px;
  border-radius: 12px;
  text-decoration: none;
  font-size: 1.13rem;
  transition: background .2s;
  box-shadow: 0 3px 10px #43e68b55;
  border: none;
  display: inline-block;
}
.home-btn-primary:hover {
  background: #30ba6e;
}
.home-btn-secondary {
  background: #232b40;
  color: #e2e8f0;
  font-weight: 500;
  padding: 13px 28px;
  border-radius: 12px;
  text-decoration: none;
  font-size: 1.13rem;
  transition: background .2s;
  border: none;
  display: inline-block;
}
.home-btn-secondary:hover {
  background: #303a56;
}

.home-welcome-points {
  flex: 1;
  background: var(--card-bg);
  border-radius: 18px;
  padding: 24px 28px;
  min-width: 270px;
  box-shadow: 0 2px 12px #ede6e622;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  margin-top: 5px;
}
.points-header {
  display: flex;
  justify-content: space-between;
  width: 100%;
  font-size: 1.08rem;
  color: var(--text-secondary);
  margin-bottom: 5px;
}
.points-level {
  background: #23324d;
  color: #c3fff6;
  border-radius: 8px;
  padding: 4px 14px;
  font-size: 0.95rem;
  font-weight: bold;
}
.points-value {
  font-size: 2.5rem;
  font-weight: 800;
  color: var(--text-primary);
  margin-bottom: 7px;
  margin-top: 0;
}
.pts-label {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--medal-gold);
  margin-left: 2px;
}
.points-progress-text {
  font-size: 0.97rem;
  color: var(--text-secondary);
  margin-bottom: 4px;
  margin-top: 8px;
  display: flex;
  justify-content: space-between;
  width: 100%;
}
.points-progress-bar {
  background: #222c3a;
  border-radius: 16px;
  width: 100%;
  height: 9px;
  margin-bottom: 8px;
  overflow: hidden;
}
.points-progress {
  background: linear-gradient(90deg, #3ef8c5, #68a5fc);
  height: 100%;
  border-radius: 16px;
  transition: width 0.4s;
}
.points-tip {
  color: #7dd3fc;
  font-size: 0.97rem;
  margin-top: 5px;
}
.home-row-cards {
  display: flex;
  gap: 24px;
  margin-bottom: 18px;
  margin-top: 0;
}
@media (max-width: 900px) {
  .home-row-cards {
    flex-direction: column;
    gap: 15px;
  }
}
.home-row-card {
  background: var(--card-header-bg);
  border-radius: 16px;
  padding: 22px 30px 18px 24px;
  flex: 1;
  min-width: 220px;
  box-shadow: 0 1px 8px #00000012;
  position: relative;
}
.home-row-card-title {
  font-size: 1.25rem;
  font-weight: bold;
  color: var(--text-primary);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 12px;
}
.home-row-card-badge {
  background: #232b40;
  color: #e2e8f0;
  padding: 3px 14px;
  border-radius: 8px;
  font-size: 0.87rem;
  margin-left: 8px;
}
.home-row-card-content {
  color: var(--text-secondary);
  font-size: 1.06rem;
  margin-bottom: 5px;
}
.home-row-card-link {
  position: absolute;
  top: 20px;
  right: 28px;
  background: #232b40;
  color: #b3b9c5;
  border-radius: 8px;
  padding: 6px 16px;
  font-size: 0.93rem;
  text-decoration: none;
  font-weight: bold;
  transition: background .2s;
}
.home-row-card-link:hover {
 background: #232b40;
}

/* --- card atividades sugeridas --- */
.home-suggested-card {
  background: var(--card-header-bg);
  border-radius: 18px;
  padding: 26px 24px 22px 24px;
  box-shadow: 0 8px 16px rgba(0,0,0,0.2);
  min-width: 300px;
  max-width: 400px;
  margin-bottom: 18px;
}
.home-suggested-title {
  color: var(--text-primary);
  font-size: 1.22rem;
  font-weight: bold;
  margin-bottom: 18px;
}
.home-suggested-list {
  list-style: none;
  padding: 0;
  margin: 0;
}
.home-suggested-list li {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 18px;
  position: relative;
}
.home-suggested-list li::before {
  content: '';
  display: block;
  width: 10px;
  height: 10px;
  background: #c3fff6;
  border-radius: 50%;
  position: absolute;
  left: -18px;
  top: 20px;
}
.suggested-activity-card {
  background: rgba(255,255,255,0.03);
  border: 1.5px solid rgba(255,255,255,0.09);
  border-radius: 14px;
  padding: 16px 18px 14px 18px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  color: var(--text-primary);
  width: 100%;
  box-sizing: border-box;
}
.suggested-btn {
  background: #232b40;
  color: #e2e8f0;
  border: none;
  padding: 6px 22px;
  font-weight: 600;
  border-radius: 7px;
  font-size: 1.08rem;
  cursor: pointer;
  transition: background 0.18s;
}
.suggested-btn:hover {
  background: #112233;
}

/* --- Home Top10 (insira no seu CSS) --- */
.home-top10-card {
  background: var(--card-header-bg);
  border-radius: 16px;
  padding: 16px;
  margin: 18px 0;
  max-width: 520px;
  box-shadow: 0 4px 18px rgba(0,0,0,0.12);
}
.home-top10-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 8px;
}
.home-top10-header h3 {
  margin: 0;
  font-size: 1.12rem;
  color: var(--text-primary);
}
.home-top10-refresh {
  background: transparent;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 1rem;
  padding: 6px;
}
.home-ranking-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.home-ranking-item {
  display: flex;
  align-items: center;
  gap: 12px;
  background: rgba(255,255,255,0.02);
  padding: 8px;
  border-radius: 10px;
}
.home-ranking-item .rank-num {
  width: 36px;
  text-align: center;
  font-weight: 700;
  color: var(--medal-gold);
}
.home-ranking-item .rank-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid rgba(255,255,255,0.06);
}
.home-ranking-item .rank-name {
  flex: 1;
  font-weight: 600;
  color: var(--text-primary);
  font-size: 0.98rem;
}
.home-ranking-item .rank-bip {
  font-weight: 700;
  color: var(--medal-gold);
  font-size: 0.95rem;
}
.home-ranking-empty {
  color: var(--text-secondary);
  padding: 8px 0;
}
.home-top10-link {
  display: inline-block;
  margin-top: 8px;
  color: #bfe3f7;
  text-decoration: none;
  font-weight: 600;
}
@media (max-width: 900px) {
  .home-top10-card { max-width: 100%; }
}

/* --- Saiba Mais Section --- */

.learn-dashboard {
  background: var(--card-header-bg);
  border-radius: 16px;
  padding: 24px;
  color: #fff;
  max-width: 1100px;
  margin: auto;
  font-family: 'Inter', sans-serif;
  box-sizing: border-box;
}
.section-title {
  font-size: 2rem;
  margin-bottom: 16px;
  font-weight: bold;
}
.learn-filters {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  justify-content: flex-end;
}
.learn-filters select {
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  background: #232b3e;
  color: #fff;
  font-size: 1rem;
  outline: none;
}

/* Grid dos cards: mant√©m comportamento responsivo */
.learn-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 20px;
  margin-bottom: 32px;
  align-items: start;
  box-sizing: border-box;
}

/* Base dos cards (inclui jogos quando virados em cards) */
.learn-card {
  background: #232b3e;
  border-radius: 12px;
  padding: 18px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
  display: flex;
  flex-direction: column;
  gap: 10px;
  position: relative;
  box-sizing: border-box;
  min-height: 120px;
  overflow: hidden; /* evita que conte√∫dos internos forcet√™m overflow */
}

.card-header {
  font-size: 0.95rem;
  color: #9abcf7;
  font-weight: 600;
}
.card-title {
  font-size: 1.15rem;
  font-weight: bold;
  margin: 0;
}
.card-status {
  position: absolute;
  top: 12px;
  right: 14px;
  font-size: 0.93rem;
  padding: 2px 10px;
  border-radius: 8px;
  background: #29304a;
  color: #ffd700;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 4px;
}
.card-status.novo { color: #ffd700; }
.card-status.andamento { color: #67cdf7; }
.card-status.concluido { color: #9af7a4; }

/* Barra de progresso dentro do card (garante que n√£o estique) */
.card-progress-bar {
  background: #1b2233;
  border-radius: 6px;
  height: 9px;
  width: 100%;
  max-width: 100%;
  margin: 8px 0;
  overflow: hidden;
  box-sizing: border-box;
}
.card-progress-bar .progress {
  background: #67cdf7;
  height: 100%;
  border-radius: 6px;
  transition: width 0.4s;
  width: 0%; /* setado inline ou via JS (ex: style="width:45%") */
  display: block;
  box-sizing: border-box;
  max-width: 100%;
}

/* Recompensa e bot√£o */
.card-reward {
  font-size: 1rem;
  color: #b3d7ff;
  margin-bottom: 4px;
}
.card-action {
  margin-top: 8px;
  background: #56e2a6;
  color: #181f2c;
  border: none;
  border-radius: 8px;
  padding: 9px 28px;
  font-weight: bold;
  font-size: 1rem;
  cursor: pointer;
  transition: background .2s;
}
.card-action:hover { background: #38cfa1; }

/* Variante visual para jogos: igual aos cards de quizzes */
.learn-card.quiz-variant {
  background: #181f2c;            /* mesmo tom do quiz-catalog-card */
  border-radius: 10px;
  padding: 14px 16px;
  border: 1.5px solid #232b3e;
  color: #fff;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
  justify-content: center;
  text-align: center;
}
.learn-card.quiz-variant .card-header { display:none; } /* opcional */
.learn-card.quiz-variant .card-title { font-size:1rem; }
.learn-card.quiz-variant .quiz-card-icon {
  width: 64px;
  height: 64px;
  object-fit: contain;
  margin: 6px auto;
  border-radius: 8px;
  background: rgba(255,255,255,0.03);
  padding: 6px;
}
.learn-card.quiz-variant .card-reward {
  color: #b3b9c5;
  font-size: 0.93rem;
}
.learn-card.quiz-variant .card-action {
  background: #43e68b;
  color: #09202a;
  padding: 8px 18px;
  border-radius: 8px;
  font-size: 0.98rem;
}
.learn-card.quiz-variant .card-action:hover { background:#30ba6e; color:#fff; }

/* --- TRILHAS / PROGRESS (corrigido) --- */
.learn-progress-trails {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 18px;
  justify-content: flex-start;
  margin-top: 16px;
  box-sizing: border-box;
}

/* Cada trail n√£o pode for√ßar a largura da coluna (min-width:0 √© essencial) */
.progress-trail {
  background: #232b3e;
  border-radius: 10px;
  padding: 15px 18px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: flex-start;
  min-height: 84px;
  box-sizing: border-box;
  min-width: 0; /* evita que conte√∫do interno estique a coluna em overflow */
}

.trail-title {
  font-size: 1rem;
  color: #9abcf7;
  font-weight: bold;
}
.trail-btn {
  background: #29304a;
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 6px 14px;
  font-size: 0.93rem;
  cursor: pointer;
}

/* Garante que a barra dentro da trail respeite o espa√ßo dispon√≠vel */
.progress-trail .card-progress-bar {
  width: 100%;
  max-width: 100%;
  margin-top: 6px;
}
/* --- Meu Perfil Section --- */
.profile-section {
  background: var(--card-header-bg);
  border-radius: 16px;
  padding: 30px 18px 24px 18px;
  color: #e9f0ff;
  max-width: 1200px;
  margin: 32px auto;
  font-family: 'Inter', sans-serif;
  box-shadow: 0 2px 24px #00000033;
}
.profile-container {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 28px;
}
.profile-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}
.profile-header h2 {
  font-size: 2rem;
  font-weight: bold;
  margin: 0;
}
.profile-edit-btn {
  background: #232b3e;
  color: #fff;
  font-weight: bold;
  border: none;
  border-radius: 10px;
  padding: 10px 24px;
  font-size: 1.09rem;
  cursor: pointer;
  transition: background .2s;
}
.profile-edit-btn:hover {
  background: #38cfa1;
  color: #181f2c;
}
.profile-columns {
  display: flex;
  gap: 24px;
  justify-content: space-between;
}
.profile-card {
  background: #232b3e;
  border-radius: 15px;
  flex: 1;
  min-width: 220px;
  padding: 22px 18px 18px 24px;
  box-shadow: 0 1px 8px #00000012;
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.profile-card h3 {
  font-size: 1.18rem;
  font-weight: bold;
  margin-bottom: 10px;
  color: #e9f0ff;
}
.profile-info-block {
  margin-bottom: 10px;
  display: flex;
  flex-direction: column;
}
.profile-label {
  color: #93a4c4;
  font-size: 1rem;
}
.profile-value {
  color: #e9f0ff;
  font-size: 1.15rem;
  font-weight: bold;
}
.profile-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}
.tag {
  background: #283447;
  color: #aee9f5;
  font-weight: bold;
  padding: 6px 20px;
  border-radius: 8px;
  font-size: 1.08rem;
  margin-bottom: 4px;
  letter-spacing: 0.02em;
}
.profile-cert-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.cert-item {
  background: #202b3e;
  border-radius: 8px;
  padding: 10px 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 4px;
}
.cert-upload-btn {
  background: #434b5e;
  color: #e9f0ff;
  border: none;
  border-radius: 7px;
  padding: 7px 22px;
  font-size: 1.02rem;
  cursor: pointer;
  transition: background .2s;
}
.cert-upload-btn:hover {
  background: #38cfa1;
  color: #181f2c;
}
.cert-upload-form {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.cert-upload-label {
  font-size: 0.98rem;
  color: #aee9f5;
  margin-bottom: 4px;
}
#cert-upload-input {
  padding: 5px 8px;
  border-radius: 6px;
  border: none;
  background: #232b3e;
  color: #e9f0ff;
}
@media (max-width: 1050px) {
  .profile-columns {
    flex-direction: column;
    gap: 14px;
  }
  .profile-card {
    min-width: 180px;
  }
}

/* --- Loja de Recompensas Section --- */
.loja-recompensas-section {
  background: var(--card-header-bg);
  border-radius: 16px;
  padding: 32px 24px 28px 24px;
  margin-bottom: 30px;
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
  box-shadow: 0 2px 24px #00000033;
}
.loja-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 22px;
  flex-wrap: wrap;
  gap: 16px;
}
.loja-title {
  font-size: 1.6rem;
  color: #fff;
  font-weight: bold;
  margin: 0;
}
.loja-tabs {
  display: flex;
  gap: 8px;
}
.loja-tab-btn {
  background: #222838;
  color: #d1e3fa;
  border: none;
  font-weight: 600;
  border-radius: 8px;
  padding: 8px 22px;
  font-size: 1.08rem;
  cursor: pointer;
  transition: background .18s, color .18s;
}
.loja-tab-btn.active,
.loja-tab-btn:focus {
  background: #313a4e;
  color: #fff;
  outline: none;
}
.loja-cards-row {
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
  align-items: stretch;
  justify-content: flex-start;
}
.loja-card {
  background: #202738;
  border-radius: 13px;
  padding: 28px 26px 22px 26px;
  min-width: 310px;
  flex: 1 1 290px;
  max-width: 340px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  margin-bottom: 18px;
  border: 1.5px solid #21293b;
  box-shadow: 0 2px 10px #0002;
  position: relative;
}
.loja-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
}
.loja-card-title {
  font-size: 1.18rem;
  color: #fff;
  font-weight: bold;
  display: block;
}
.loja-card-points {
  background: #25354d;
  color: #bfe3f7;
  font-size: 0.98rem;
  border-radius: 7px;
  padding: 5.5px 14px;
  margin-left: 8px;
  font-weight: 600;
  align-self: flex-start;
}
.loja-card-desc {
  color: #8fb8f7;
  font-size: 1.01rem;
  margin-bottom: 18px;
}
.loja-card-btn {
  background: #52f9c2;
  color: #15243d;
  padding: 11px 0;
  font-size: 1.11rem;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: background .18s, color .18s, transform .14s;
  margin-top: auto;
}
.loja-card-btn:hover {
  background: #38cfa1;
  color: #fff;
  transform: translateY(-2px);
}
@media (max-width: 900px) {
  .loja-recompensas-section { padding: 18px 6px; }
  .loja-header-row { flex-direction: column; align-items: flex-start; gap: 10px; }
  .loja-cards-row { flex-direction: column; gap: 18px; }
  .loja-card { min-width: 0; width: 100%; }
}

/* --- Quizzes Section --- */
.quizzes-section {
  background: var(--card-bg);
  border-radius: 18px;
  padding: 32px 18px 38px 18px;
  margin-bottom: 30px;
  box-shadow: 0 8px 24px #0002;
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
}
.quizzes-header-row {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 24px;
  gap: 16px;
}
.section-desc {
  color: var(--text-secondary);
  font-size: 1.11rem;
  margin-top: 3px;
}
.quizzes-header-actions {
  display: flex;
  gap: 14px;
}
.quiz-btn {
  background: #232b40;
  color: #e2e8f0;
  border: none;
  padding: 10px 26px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 1.06rem;
  cursor: pointer;
  transition: background .15s, color .15s;
}
.quiz-btn:hover {
  background: #313a4e;
  color: #fff;
}
.quiz-btn-green {
  background: #43e68b;
  color: #14213d;
}
.quiz-btn-green:hover {
  background: #30ba6e;
  color: #fff;
}
.quiz-btn-danger {
  background: #b51414;
  color: #fff;
}
.quiz-btn-danger:hover {
  background: #d42e2e;
}
.quiz-btn-small {
  padding: 6px 14px;
  font-size: 0.97rem;
}
.quiz-btn-mini {
  padding: 4px 10px;
  font-size: 0.9rem;
}
.quizzes-main-grid {
  display: grid;
  grid-template-columns: 1fr 2.2fr;
  gap: 26px;
  margin-bottom: 28px;
}
.quiz-catalog {
  background: var(--card-header-bg);
  border-radius: 12px;
  padding: 18px 14px 16px 14px;
  min-width: 260px;
  min-height: 330px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.quiz-catalog-title {
  color: #b3b9c5;
  font-size: 1.07rem;
  margin-bottom: 10px;
}
.quiz-catalog-card {
  background: #181f2c;
  border-radius: 10px;
  padding: 15px 18px;
  margin-bottom: 8px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  border: 1.5px solid #232b3e;
}
.quiz-catalog-card-title {
  font-weight: bold;
  color: #fff;
  font-size: 1.13rem;
}
.quiz-catalog-card-sub {
  color: #b3b9c5;
  font-size: 0.98rem;
}
.quiz-catalog-card-actions {
  display: flex;
  gap: 8px;
  margin-top: 7px;
}
.quiz-editor {
  background: var(--card-header-bg);
  border-radius: 12px;
  padding: 18px 18px 22px 18px;
  min-height: 330px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  position: relative;
}
.quiz-editor-header {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-bottom: 8px;
}
.quiz-editor-step {
  background: #232b3e;
  color: #8fb8f7;
  border-radius: 7px;
  padding: 5px 13px;
  font-size: 0.97rem;
  font-weight: 500;
}
.quiz-editor-step-active {
  background: #67cdf7;
  color: #1b2233;
}
.quiz-editor-status {
  background: #313a4e;
  color: #fff;
  border-radius: 8px;
  padding: 5px 13px;
  margin-left: 16px;
  font-size: 0.98rem;
  font-weight: 500;
}
.quiz-editor-autosave {
  color: #7dd3fc;
  margin-left: auto;
  font-size: 0.96rem;
}
.quiz-editor-row {
  display: flex;
  gap: 24px;
  margin-bottom: 4px;
}
.quiz-editor-field {
  display: flex;
  flex-direction: column;
  flex: 1;
  gap: 5px;
}
.quiz-editor-field label {
  color: #b3b9c5;
  font-size: 0.99rem;
  margin-bottom: 2px;
}
.quiz-input {
  background: #232b3e;
  color: #e2e8f0;
  border: none;
  border-radius: 7px;
  padding: 10px 12px;
  font-size: 1.07rem;
  outline: none;
  margin-top: 1px;
}
.quiz-input-search {
  min-width: 200px;
}
.quiz-input-mini {
  padding: 7px 18px;
  font-size: 1.02rem;
}
.quiz-editor-perguntas {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 7px;
}
.quiz-editor-perguntas-title {
  color: #b3b9c5;
  font-size: 1.1rem;
  font-weight: bold;
}
.quiz-review-box {
  background: #181f2c;
  border-radius: 8px;
  padding: 18px 17px 12px 17px;
  margin-bottom: 8px;
  margin-top: 6px;
}
.quiz-review-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: #fff;
  font-size: 1.13rem;
  margin-bottom: 7px;
}
.quiz-review-list {
  list-style: none;
  padding: 0;
  margin: 0;
  color: #b3b9c5;
  font-size: 1.07rem;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.quiz-review-ok {
  color: #b3f7b7;
}
.quiz-review-alert {
  color: #ffd700;
}
.quiz-editor-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 10px;
}
.quizzes-published {
  background: var(--card-header-bg);
  border-radius: 12px;
  padding: 22px 22px 20px 22px;
  margin-top: 18px;
}
.quizzes-published-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}
.quizzes-published-title {
  color: #fff;
  font-size: 1.21rem;
  font-weight: bold;
}
.quizzes-published-actions {
  display: flex;
  gap: 10px;
  align-items: center;
}
.quizzes-published-list {
  color: #b3b9c5;
  font-size: 1.03rem;
  min-height: 36px;
}
.quizzes-published-empty {
  color: #b3b9c5;
  font-size: 1.08rem;
  opacity: 0.7;
}
@media (max-width: 900px) {
  .quizzes-main-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  .quizzes-section {
    padding: 14px 2px 34px 2px;
  }
}

/* ===== MOBILE MENU HAMBURGUER E LAYOUT MOBILE ===== */
@media (max-width: 900px) {
  html {
    font-size: 14px !important;
  }
  body {
    flex-direction: column !important;
    min-width: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Sidebar VIRA menu hamburguer lateral */
  .sidebar {
    width: 220px !important;
    min-width: 180px !important;
    max-width: 80vw !important;
    height: 100vh !important;
    min-height: 100vh !important;
    max-height: 100vh !important;
    flex-direction: column !important;
    align-items: stretch !important;
    position: fixed !important;
    top: 0;
    left: -230px; /* escondida por padr√£o */
    z-index: 999;
    transition: left 0.33s cubic-bezier(0.7,0,0.3,1);
    box-shadow: 2px 0 22px #0007;
    border-radius: 0 18px 18px 0;
    overflow-y: auto;
  }
  .sidebar.open {
    left: 0 !important;
  }
  .sidebar-backdrop {
    display: none;
    position: fixed;
    z-index: 998;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.29);
    transition: opacity 0.33s;
  }
  .sidebar.open ~ .sidebar-backdrop {
    display: block !important;
    opacity: 1;
  }

  /* Exibe bot√£o hamburguer */
  #sidebar-toggle {
    display: block !important;
    position: fixed;
    top: 14px;
    left: 16px;
    z-index: 1001;
  }

  /* Sidebar menu */
  .sidebar .logo { display: flex !important; }
  .sidebar-nav {
    flex-direction: column !important;
    gap: 12px !important;
    margin-top: 40px !important;
    width: 100% !important;
  }
  .sidebar-nav .nav-icon {
    flex: unset !important;
    justify-content: flex-start !important;
    padding: 16px 32px !important;
    border-radius: 12px 0 0 12px !important;
    border-left: 5px solid transparent !important;
    border-bottom: none !important;
    font-size: 1.13rem !important;
    text-align: left !important;
  }
  .sidebar-nav .nav-icon.active, .sidebar-nav .nav-icon:hover {
    border-left: 5px solid var(--medal-gold) !important;
    background: var(--sidebar-active) !important;
  }

  /* Conte√∫do principal ocupa tela toda */
  .main-content {
    margin-left: 0 !important;
    padding: 72px 3px 10px 3px !important;
    width: 100vw !important;
    min-width: 0 !important;
    box-sizing: border-box !important;
  }

  /* Topbar compacta */
  .topbar {
    flex-direction: column !important;
    align-items: center !important;
    padding: 8px 0 3px 0 !important;
    gap: 4px !important;
  }
  .topbar-user {
    flex-direction: row !important;
    padding: 8px 10px 8px 8px !important;
    gap: 7px !important;
    width: 100%;
    box-sizing: border-box;
    justify-content: flex-start;
  }
  .avatar-lg {
    width: 42px !important;
    height: 42px !important;
  }
  .topbar-info h2 {
    font-size: 1rem !important;
  }
  .xp-badge {
    font-size: 0.90rem !important;
    padding: 3px 7px !important;
    margin-top: 0 !important;
  }

  /* Cards e sections compactos */
  .main-content,
  .home-section,
  .profile-section,
  .learn-dashboard,
  .ponto-section,
  .ranking-section,
  .loja-recompensas-section,
  .quizzes-section,
  .fun-section {
    border-radius: 0 !important;
    box-shadow: none !important;
    margin: 0 0 10px 0 !important;
    padding: 5px 1px !important;
    width: 100vw !important;
    max-width: 100vw !important;
  }

  .home-container { padding: 0 !important; }
  .home-welcome-row {
    flex-direction: column !important;
    gap: 6px !important;
    padding: 7px 2px 7px 2px !important;
    border-radius: 8px !important;
    align-items: stretch !important;
  }
  .home-welcome-title {
    font-size: 1rem !important;
    text-align: center !important;
    margin-bottom: 5px !important;
  }
  .home-welcome-desc {
    font-size: 0.94rem !important;
    text-align: center !important;
  }
  .home-welcome-actions {
    flex-direction: column !important;
    gap: 3px !important;
    align-items: center !important;
  }
  .home-welcome-points {
    min-width: 0 !important;
    width: 100% !important;
    padding: 5px 2px !important;
    border-radius: 7px !important;
    margin-top: 0 !important;
    align-items: flex-start;
  }
  .home-row-cards {
    flex-direction: column !important;
    gap: 6px !important;
    margin-bottom: 4px !important;
  }
  .home-row-card {
    padding: 6px 2px !important;
    border-radius: 7px !important;
    min-width: 0 !important;
    box-shadow: none !important;
  }
  .home-row-card-title {
    font-size: 0.97rem !important;
    gap: 4px !important;
  }

  /* Bot√µes menores */
  .home-btn-primary,
  .home-btn-secondary,
  .cta-button,
  .quiz-btn,
  .play-button {
    font-size: 0.90rem !important;
    padding: 7px 10px !important;
    border-radius: 4px !important;
  }
  .home-row-card-link {
    position: static !important;
    margin-top: 5px !important;
    display: block !important;
    width: fit-content;
  }
}

/* TELA BEM PEQUENA: REDUZ TUDO AINDA MAIS */
@media (max-width: 600px) {
  html {
    font-size: 12px !important;
  }
  .avatar-lg {
    width: 34px !important;
    height: 34px !important;
  }
  .main-content,
  .home-welcome-row,
  .dashboard-card,
  .fun-section,
  .profile-section,
  .ranking-section,
  .loja-recompensas-section,
  .quizzes-section {
    padding: 2px 0 !important;
  }
  .home-welcome-title {
    font-size: 0.91rem !important;
    margin-bottom: 3px !important;
  }
  .home-row-card {
    padding: 3px 2px !important;
  }
  .home-btn-primary,
  .home-btn-secondary,
  .cta-button,
  .quiz-btn,
  .play-button {
    font-size: 0.80rem !important;
    padding: 5px 7px !important;
    border-radius: 3px !important;
  }
}

/* ======= CORRE√á√ÉO GERAL DE ZOOM E OVERFLOW ======= */
html, body {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden !important;
  zoom: 1 !important;
  touch-action: pan-x pan-y !important; /* permite arrastar e zoom */
}

.main-content, section, .content, .container {
  max-width: 100% !important;
  overflow-x: hidden !important;
  box-sizing: border-box;
}

/* Remove margens for√ßadas em mobile */
@media (max-width: 900px) {
  body, html {
    margin: 0;
    padding: 0;
  }
  .main-content {
    margin-left: 0 !important;
    padding: 80px 12px 32px 12px !important;
  }
}

/* ==== CORRE√á√ÉO FINAL DE ZOOM E CORTE ==== */
html, body {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden !important;
  overflow-y: auto !important;
  margin: 0;
  padding: 0;
  touch-action: pan-x pan-y pinch-zoom !important;
}

.main-content, section, .content, .container {
  width: 100% !important;
  max-width: 100% !important;
  overflow-x: hidden !important;
  box-sizing: border-box;
}

@media (max-width: 900px) {
  .main-content {
    margin-left: 0 !important;
    padding: 80px 14px 32px 14px !important;
  }
}

/* Evita overflow causado por 100vw */
*[style*="width:100vw"] {
  width: 100% !important;
}



   </style>
</head>
<body>
  <button id="sidebar-toggle" aria-label="Abrir menu" style="display:none;position:fixed;top:14px;left:16px;z-index:999;background:var(--sidebar-bg);border:none;padding:10px 13px;border-radius:7px;color:#fff;font-size:1.4rem;box-shadow:0 2px 12px #0004;">
    &#9776;
</button>
    <div class="sidebar">
       <div class="logo">
  <img src="assets/resources/growsemfundo.png" alt="Mascote Grow" style="height:38px;vertical-align:middle;">
  <span style="margin-left:0px;">Grow System</span>
</div>
        <nav class="sidebar-nav">
  
            <div class="nav-icon active" onclick="showSection('home')">
                <i data-lucide="home"></i>
                <span>Inicio</span>
            </div>
            <div class="nav-icon" onclick="showSection('profile')">
    <i data-lucide="user"></i>
    <span>Meu Perfil</span>
</div>
            <div class="nav-icon" onclick="showSection('learn')">
                <i data-lucide="book-open"></i>
                <span>Saiba Mais</span>
            </div>
            <div class="nav-icon" onclick="showSection('ponto')">
                <i data-lucide="clock"></i>
                <span>Ponto</span>
            </div>
            <div class="nav-icon" onclick="showSection('ranking')">
                <i data-lucide="trophy"></i>
                <span>Ranking</span>
            </div>
            <div class="nav-icon" onclick="showSection('store')">
    <i data-lucide="shopping-cart"></i>
    <span>Loja</span>
</div>
<div class="nav-icon" onclick="showSection('quizzes')">
    <i data-lucide="list-todo"></i>
    <span>Quizzes</span>
</div>
<div class="nav-icon" id="nav-gestao" onclick="showSection('gestao')" style="display:none;">
  <i data-lucide="settings"></i>
  <span>Gest√£o</span>
</div>
        </nav>
    </div>
    <div class="sidebar-backdrop"></div>
    <div class="main-content">
        <div class="topbar">
            <div class="topbar-user">
                <div class="avatar-lg">
                    <img id="user-avatar" src="https://via.placeholder.com/60" alt="Avatar">
                </div>
                <div class="topbar-info">
                    <h2 id="username">Usu√°rio</h2>
                    <div class="xp-badge">
                        <svg class="gold-coin" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="vertical-align:middle;">
                            <circle cx="12" cy="12" r="10" fill="#FFB74D"/>
                            
                        </svg>
                        <span id="user-xp">0 BIP</span>
                    </div>
                </div>
            </div>
            <input type="file" id="avatar-upload" accept="image/*" style="display:none;">
        </div>
        <!-- SECTIONS -->
  <section class="home-section" id="home-section">
  <!-- Container principal -->
  <div class="home-container">
    <div class="home-welcome-row">
      <div class="home-welcome-main">
        <h1 class="home-welcome-title">
          Bem-vindo, <span id="nome-usuario-boasvindas">Usu√°rio</span>! Pronto para evoluir e ganhar recompensas?
        </h1>
        <p class="home-welcome-desc">
          Complete desafios, aprenda com jogos e suba no ranking da sua equipe.
        </p>
        <div class="home-welcome-actions">
          <a href="quizlgbt.html" class="home-btn-primary">Jogar Quiz de Seguran√ßa (+50)</a>
          <a href="#" class="home-btn-secondary">Ir para Recompensas</a>
        </div>
      </div>
      <div class="home-welcome-points">
        <div class="points-header">
          <span>Saldo de Pontos</span>
          <span class="points-level">N√≠vel <span id="user-nivel">1</span></span>
        </div>
        <div class="points-value" id="user-saldo-pontos">0 <span class="pts-label">pts</span></div>
        <div class="points-progress-text">
          Meta da Semana <span id="user-meta-porcento">0%</span>
        </div>
        <div class="points-progress-bar">
          <div class="points-progress" id="user-meta-bar" style="width: 0%;"></div>
        </div>
        <div class="points-tip">
          Dica: complete 1 miss√£o por dia para b√¥nus extras.
        </div>
      </div>
    </div>

    <div class="home-row-cards">
      <div class="home-row-card">
        <div class="home-row-card-title">
          Continuar de onde parei
          <span class="home-row-card-badge">Quizzes</span>
        </div>
        <div class="home-row-card-content" id="continue-content">
          Sem progresso em andamento.
        </div>
      </div>
      <div class="home-row-card">
        <div class="home-row-card-title">
          Novos para voc√™
        </div>
        <div class="home-row-card-content" id="novos-content">
          Sem quizzes publicados. Crie um em Quizzes.
        </div>
        <a href="#" class="home-row-card-link">Ver todos</a>
      </div>
    </div>

    <!-- Novo: Cart√£o Top 10 -->
    <div class="home-top10-card">
      <div class="home-top10-header">
        <h3>Top 10 da Semana</h3>
        <button class="home-top10-refresh" id="home-top10-refresh" title="Atualizar">üîÑ</button>
      </div>
      <ul id="home-ranking-list" class="home-ranking-list">
        <!-- Items ser√£o preenchidos via JS -->
        <li class="home-ranking-empty">Carregando ranking...</li>
      </ul>
      <a href="#" class="home-top10-link" onclick="showSection('ranking'); return false;">Ver ranking completo ‚Üí</a>
    </div>
    <!-- Fim Top 10 -->

  </div>

  <!-- Card de Atividades Sugeridas -->
  <div class="home-suggested-card">
    <div class="home-suggested-title">Atividades Sugeridas</div>
    <ul class="home-suggested-list">
      <li>
        <div class="suggested-activity-card">
          <span>Conclua ‚ÄúEPIs‚Äù hoje e ganhe +20!</span>
          <button class="suggested-btn">Abrir</button>
        </div>
      </li>
      <li>
        <div class="suggested-activity-card">
          <span>Atualize suas certifica√ß√µes</span>
          <button class="suggested-btn">Abrir</button>
        </div>
      </li>
      <li>
        <div class="suggested-activity-card">
          <span>Troque 300 pts por Voucher</span>
          <button class="suggested-btn">Abrir</button>
        </div>
      </li>
    </ul>
  </div>
</section>
     <section class="learn-dashboard" id="learn-section">
  <h2 class="section-title">Games & Aprendizado</h2>
  <div class="learn-filters">
    <select>
      <option>Todas categorias</option>
      <option>Seguran√ßa</option>
      <option>√âtica</option>
      <option>Inclus√£o</option>
      <option>Inova√ß√£o</option>
    </select>
    <select>
      <option>Todos</option>
      <option>Novo</option>
      <option>Em andamento</option>
      <option>Conclu√≠do</option>
    </select>
  </div>
  <div class="learn-cards-grid">
    <!-- Card 1: LGBTQIA+ Fobia -->
    <div class="learn-card categoria-inclusao">
      <div class="card-header">Inclus√£o</div>
      <h3 class="card-title">Conscientiza√ß√£o contra a LGBTQIA+ fobia</h3>
      <div class="card-status novo">‚ú® Novo</div>
      <div class="card-progress-bar"><div class="progress" style="width: 0%"></div></div>
      <div class="card-reward">Recompensa: <strong>+50 pts</strong></div>
      <button class="card-action" onclick="window.location.href='quizlgbt.html'">Jogar</button>
    </div>
    <!-- Card 2: Pessoas Surdas -->
    <div class="learn-card categoria-inclusao">
      <div class="card-header">Inclus√£o</div>
      <h3 class="card-title">Pessoas Surdas</h3>
      <div class="card-status andamento">‚è≥ Em andamento</div>
      <div class="card-progress-bar"><div class="progress" style="width: 35%"></div></div>
      <div class="card-reward">Recompensa: <strong>+60 pts</strong></div>
      <button class="card-action" onclick="window.location.href='quizlibras.html'">Jogar</button>
    </div>
    <!-- Card 3: Hist√≥ria do SENAI -->
    <div class="learn-card categoria-inovacao">
      <div class="card-header">Inova√ß√£o</div>
      <h3 class="card-title">Hist√≥ria do SENAI</h3>
      <div class="card-status concluido">‚úîÔ∏è Conclu√≠do</div>
      <div class="card-progress-bar"><div class="progress" style="width: 100%"></div></div>
      <div class="card-reward">Conclu√≠do ‚Ä¢ +30 pts</div>
      <button class="card-action" onclick="window.location.href='Quiz.html'">Rever</button>
    </div>
    <!-- Card 4: Seguran√ßa do Trabalho -->
    <div class="learn-card categoria-seguranca">
      <div class="card-header">Seguran√ßa</div>
      <h3 class="card-title">Seguran√ßa do Trabalho: B√°sico</h3>
      <div class="card-status novo">‚ú® Novo</div>
      <div class="card-progress-bar"><div class="progress" style="width: 0%"></div></div>
      <div class="card-reward">Recompensa: <strong>+50 pts</strong></div>
      <button class="card-action">Jogar</button>
    </div>
    <!-- Card 5: √âtica nas Decis√µes -->
    <div class="learn-card categoria-etica">
      <div class="card-header">√âtica</div>
      <h3 class="card-title">√âtica nas Decis√µes</h3>
      <div class="card-status andamento">‚è≥ Em andamento</div>
      <div class="card-progress-bar"><div class="progress" style="width: 60%"></div></div>
      <div class="card-reward">Recompensa: <strong>+40 pts</strong></div>
      <button class="card-action">Jogar</button>
    </div>
    <!-- Card 6: √âtica & Compliance -->
    <div class="learn-card categoria-etica">
      <div class="card-header">√âtica</div>
      <h3 class="card-title">√âtica & Compliance</h3>
      <div class="card-status novo">‚ú® Novo</div>
      <div class="card-progress-bar"><div class="progress" style="width: 0%"></div></div>
      <div class="card-reward">Recompensa: <strong>+45 pts</strong></div>
      <button class="card-action">Jogar</button>
    </div>
    <!-- Card 7: Inova√ß√£o em Processos -->
    <div class="learn-card categoria-inovacao">
      <div class="card-header">Inova√ß√£o</div>
      <h3 class="card-title">Inova√ß√£o em Processos</h3>
      <div class="card-status novo">‚ú® Novo</div>
      <div class="card-progress-bar"><div class="progress" style="width: 0%"></div></div>
      <div class="card-reward">Recompensa: <strong>+30 pts</strong></div>
      <button class="card-action">Jogar</button>
    </div>
    <!-- Card 8: Seguran√ßa EPIs -->
    <div class="learn-card categoria-seguranca">
      <div class="card-header">Seguran√ßa</div>
      <h3 class="card-title">Seguran√ßa: EPIs</h3>
      <div class="card-status andamento">‚è≥ Em andamento</div>
      <div class="card-progress-bar"><div class="progress" style="width: 45%"></div></div>
      <div class="card-reward">Recompensa: <strong>+30 pts</strong></div>
      <button class="card-action">Jogar</button>
    </div>

    <!-- JOGOS: agora como cards iguais aos quizzes (variant quiz-variant) -->
    <div class="learn-card quiz-variant">
      <img src="assets/resources/memoria.png" alt="Jogo da Mem√≥ria" class="quiz-card-icon">
      <h3 class="card-title">Jogo da Mem√≥ria</h3>
      <div class="card-reward">Mini-Game</div>
      <button class="card-action" onclick="window.location.href='memoria.html'">Jogar</button>
    </div>

    <div class="learn-card quiz-variant">
      <img src="assets/Fire/fire-extinguisher.png" alt="Combate ao Fogo" class="quiz-card-icon">
      <h3 class="card-title">Combate ao Fogo</h3>
      <div class="card-reward">Simula√ß√£o</div>
      <button class="card-action" onclick="window.location.href='fire.html'">Jogar</button>
    </div>

    <div class="learn-card quiz-variant">
      <img src="assets/resources/th (9).jpeg" alt="Jogo do Juninho" class="quiz-card-icon">
      <h3 class="card-title">Jogo do Juninho</h3>
      <div class="card-reward">Mini Game</div>
      <button class="card-action" onclick="window.location.href='detroit.html'">Jogar</button>
    </div>

  </div>
  <div class="learn-progress-trails">
    <div class="progress-trail">
      <div class="trail-title">Progresso Inclus√£o</div>
      <button class="trail-btn">Trilha</button>
      <div class="card-progress-bar"><div class="progress" style="width: 44%"></div></div>
    </div>
    <div class="progress-trail">
      <div class="trail-title">Progresso √âtica</div>
      <button class="trail-btn">Trilha</button>
      <div class="card-progress-bar"><div class="progress" style="width: 66%"></div></div>
    </div>
    <div class="progress-trail">
      <div class="trail-title">Progresso Seguran√ßa</div>
      <button class="trail-btn">Trilha</button>
      <div class="card-progress-bar"><div class="progress" style="width: 59%"></div></div>
    </div>
  </div>
</section>

<section class="profile-section" id="profile-section" style="display:none;">
  <div class="profile-container">
    <div class="profile-header">
      <h2>Meu Perfil Profissional</h2>
      <button class="profile-edit-btn">Editar</button>
    </div>
    <div class="profile-columns">
      <!-- Informa√ß√µes Pessoais -->
      <div class="profile-card">
        <h3>Informa√ß√µes Pessoais</h3>
        <div class="profile-info-block">
          <span class="profile-label">Nome</span>
          <span class="profile-value">Ana Souza</span>
        </div>
        <div class="profile-info-block">
          <span class="profile-label">Cargo ‚Ä¢ Departamento</span>
          <span class="profile-value">Analista de Dados ‚Ä¢ Opera√ß√µes</span>
        </div>
      </div>
      <!-- Compet√™ncias e Habilidades -->
      <div class="profile-card">
        <h3>Compet√™ncias e Habilidades</h3>
        <div class="profile-tags">
          <span class="tag">SQL</span>
          <span class="tag">Power BI</span>
          <span class="tag">Comunica√ß√£o</span>
          <span class="tag">Colabora√ß√£o</span>
          <span class="tag">Seguran√ßa</span>
        </div>
      </div>
      <!-- Forma√ß√£o e Certifica√ß√µes -->
      <div class="profile-card">
        <h3>Forma√ß√£o e Certifica√ß√µes</h3>
        <div class="profile-cert-list">
          <div class="cert-item">
            <span>LGPD Essentials (2023)</span>
            <button class="cert-upload-btn">Upload</button>
          </div>
          <div class="cert-item">
            <span>Trilha √âtica ‚Ä¢ Interm.</span>
            <button class="cert-upload-btn">Upload</button>
          </div>
          <div class="cert-item">
            <span>Curso Inclus√£o (2024)</span>
            <button class="cert-upload-btn">Upload</button>
          </div>
        </div>
        <div class="cert-upload-form">
          <label for="cert-upload-input" class="cert-upload-label">Enviar certificado (PDF)</label>
          <input type="file" id="cert-upload-input" accept=".pdf">
        </div>
      </div>
      <!-- Interesses -->
      <div class="profile-card">
        <h3>Interesses</h3>
        <div class="profile-tags">
          <span class="tag">Lideran√ßa</span>
          <span class="tag">Inova√ß√£o</span>
          <span class="tag">An√°lise de Dados</span>
        </div>
      </div>
    </div>
  </div>
</section>

   <section class="ponto-section" id="ponto-section">
                <h2 class="section-title">Hist√≥rico de Pontos</h2>
                <div class="history-table-container">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Hora</th>
                                <th>Moedas Ganhas</th>
                            </tr>
                        </thead>
                        <tbody id="history-table-body">
                        </tbody>
                    </table>
                </div>
            </section>
        <section class="ranking-section" id="ranking-section" style="display:none;">
            <h2 class="section-title">Ranking da Semana</h2>
            <table class="ranking-table">
                <thead>
                    <tr>
                        <th>Posi√ß√£o</th>
                        <th>Usu√°rio</th>
                        <th>BIP</th>
                    </tr>
                </thead>
                <tbody id="ranking-body"></tbody>
            </table>
        </section>

        <!-- Loja de Recompensas - Section para o Dashboard -->
<section class="loja-recompensas-section" id="store-section" style="display:none;">
  <div class="loja-recompensas-container">
    <div class="loja-header-row">
      <h2 class="loja-title">Loja de Recompensas</h2>
      <div class="loja-tabs">
        <button class="loja-tab-btn active" data-tab="vouchers" onclick="showLojaTab('vouchers')">Vouchers</button>
        <button class="loja-tab-btn" data-tab="beneficios" onclick="showLojaTab('beneficios')">Benef√≠cios</button>
        <button class="loja-tab-btn" data-tab="produtos" onclick="showLojaTab('produtos')">Produtos</button>
      </div>
    </div>
    <!-- Vouchers Tab -->
    <div class="loja-cards-row loja-tab-content" id="loja-tab-vouchers">
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Cupon R$ 50 Loja X</span>
          <span class="loja-card-points">300 pts</span>
        </div>
        <div class="loja-card-desc">Vouchers e descontos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Desconto 20% App Y</span>
          <span class="loja-card-points">220 pts</span>
        </div>
        <div class="loja-card-desc">Vouchers e descontos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Voucher Cinema</span>
          <span class="loja-card-points">180 pts</span>
        </div>
        <div class="loja-card-desc">Vouchers e descontos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
    </div>
    <!-- Benef√≠cios Tab -->
    <div class="loja-cards-row loja-tab-content" id="loja-tab-beneficios" style="display:none;">
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Day Off</span>
          <span class="loja-card-points">600 pts</span>
        </div>
        <div class="loja-card-desc">Benef√≠cios internos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Hor√°rio Flex por 1 semana</span>
          <span class="loja-card-points">450 pts</span>
        </div>
        <div class="loja-card-desc">Benef√≠cios internos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Almo√ßo com L√≠der</span>
          <span class="loja-card-points">350 pts</span>
        </div>
        <div class="loja-card-desc">Benef√≠cios internos</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
    </div>
    <!-- Produtos Tab -->
    <div class="loja-cards-row loja-tab-content" id="loja-tab-produtos" style="display:none;">
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Camiseta Oficial</span>
          <span class="loja-card-points">320 pts</span>
        </div>
        <div class="loja-card-desc">Produtos da empresa</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Garrafa T√©rmica</span>
          <span class="loja-card-points">260 pts</span>
        </div>
        <div class="loja-card-desc">Produtos da empresa</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
      <div class="loja-card">
        <div class="loja-card-header">
          <span class="loja-card-title">Caderno Personalizado</span>
          <span class="loja-card-points">140 pts</span>
        </div>
        <div class="loja-card-desc">Produtos da empresa</div>
        <button class="loja-card-btn">Resgatar</button>
      </div>
    </div>
  </div>
</section>

<section class="quizzes-section" id="quizzes-section" style="display:none;">
  <div class="quizzes-header-row">
    <div>
      <h2 class="section-title" style="margin-bottom:0;">Quizzes</h2>
      <div class="section-desc">Crie, revise, publique e jogue quizzes personalizados.</div>
    </div>
    <div class="quizzes-header-actions">
      <button class="quiz-btn quiz-btn-green">Novo Quiz</button>
      <button class="quiz-btn">Exportar</button>
    </div>
  </div>
  <div class="quizzes-main-grid">
    <div class="quiz-catalog">
      <div class="quiz-catalog-title">Seu Cat√°logo</div>
      <div class="quiz-catalog-card">
        <div>
          <div class="quiz-catalog-card-title">Sem t√≠tulo</div>
          <div class="quiz-catalog-card-sub">Seguran√ßa ‚Ä¢ 0 perg.</div>
        </div>
        <div class="quiz-catalog-card-actions">
          <button class="quiz-btn quiz-btn-small">Editar</button>
          <button class="quiz-btn quiz-btn-small quiz-btn-danger">Excluir</button>
        </div>
      </div>
    </div>
    <div class="quiz-editor">
      <div class="quiz-editor-header">
        <span class="quiz-editor-step quiz-editor-step-active">1. Detalhes</span>
        <span>‚Üí</span>
        <span class="quiz-editor-step">2. Perguntas</span>
        <span>‚Üí</span>
        <span class="quiz-editor-step">3. Revis√£o</span>
        <span class="quiz-editor-status">Revis√£o</span>
        <span class="quiz-editor-autosave">Autosave</span>
      </div>
      <div class="quiz-editor-row">
        <div class="quiz-editor-field">
          <label for="quiz-title">T√≠tulo do Quiz</label>
          <input id="quiz-title" class="quiz-input" placeholder="Ex: Seguran√ßa 101">
        </div>
        <div class="quiz-editor-field">
          <label for="quiz-category">Categoria</label>
          <select id="quiz-category" class="quiz-input">
            <option>Seguran√ßa</option>
            <option>√âtica</option>
            <option>Inclus√£o</option>
            <option>Inova√ß√£o</option>
          </select>
        </div>
      </div>
      <div class="quiz-editor-perguntas">
        <div class="quiz-editor-perguntas-title">Perguntas</div>
        <div>
          <button class="quiz-btn quiz-btn-small">+ Adicionar Pergunta</button>
          <button class="quiz-btn quiz-btn-small">Ir para Revis√£o</button>
        </div>
      </div>
      <div class="quiz-review-box">
        <div class="quiz-review-header">
          Revis√£o
          <button class="quiz-btn quiz-btn-mini">Testar</button>
        </div>
        <ul class="quiz-review-list">
          <li class="quiz-review-alert">‚ö†Ô∏è Tem um t√≠tulo claro</li>
          <li class="quiz-review-ok">‚úÖ Categoria selecionada</li>
          <li class="quiz-review-alert">‚ö†Ô∏è Possui ao menos 1 pergunta</li>
          <li class="quiz-review-ok">‚úÖ Cada pergunta tem 2+ alternativas</li>
          <li class="quiz-review-ok">‚úÖ Cada pergunta tem 1 resposta correta</li>
        </ul>
      </div>
      <div class="quiz-editor-actions">
        <button class="quiz-btn">Salvar Rascunho</button>
        <button class="quiz-btn quiz-btn-green">Publicar</button>
      </div>
    </div>
  </div>
  <div class="quizzes-published">
    <div class="quizzes-published-header">
      <span class="quizzes-published-title">Quizzes Publicados</span>
      <div class="quizzes-published-actions">
        <input class="quiz-input quiz-input-search" placeholder="Buscar quiz...">
        <select class="quiz-input quiz-input-mini">
          <option>Todas</option>
        </select>
      </div>
    </div>
    <div class="quizzes-published-list">
      <span class="quizzes-published-empty">Nenhum quiz publicado</span>
    </div>
  </div>
</section>

        <footer>
            <p>Gamifica√ß√£o &copy; 2025 - Todos os direitos reservados</p>
        </footer>
    </div>
    <script>

      // Function da Loja //
      function showLojaTab(tab) {
  document.querySelectorAll('.loja-tab-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.tab === tab) btn.classList.add('active');
  });
  document.querySelectorAll('.loja-tab-content').forEach(tabEl => {
    tabEl.style.display = 'none';
  });
  document.getElementById('loja-tab-' + tab).style.display = 'flex';
}
       // Ranking global vem sempre do backend
let rankingData = [];

// Usu√°rio logado (come√ßa vazio, ser√° carregado do backend)
let usuarioLogado = {
    id: null,
    nome: "Usu√°rio",
    avatar: "https://via.placeholder.com/60",
    moedas: 0
};

// üîπ Buscar usu√°rio logado no backend
async function fetchUsuarioLogado(id) {
    try {
        const res = await fetch(`https://meu-site4.onrender.com/api/usuario-logado/${id}`);
        const data = await res.json();
       if (data.status === "sucesso") {
    usuarioLogado = data.usuario;

    // === Controle da aba Gestor ===
    const secaoGestor = document.getElementById("secaoGestor"); // substitua pelo ID real da aba Gestor
    if (secaoGestor) {
        if (usuarioLogado.tipoUsuario === "gestor") {
            secaoGestor.style.display = "block";
        } else {
            secaoGestor.style.display = "none";
        }
    }

} else {
    console.warn("Usu√°rio n√£o encontrado no backend.");
}

    } catch (err) {
        console.error("Erro ao buscar usu√°rio logado:", err);
    }
}

// üîπ Atualiza os dados do usu√°rio logado puxando moedas do backend
async function fetchAndUpdateUserData() {
    if (usuarioLogado.id) {
        try {
            const moedasResponse = await fetch(`https://meu-site4.onrender.com/api/moedas/${usuarioLogado.id}`);
            const moedasData = await moedasResponse.json();

            if (moedasData.status === 'sucesso' && moedasData.moedas !== undefined) {
                usuarioLogado.moedas = moedasData.moedas;
            } else {
                console.error('Erro ao buscar moedas:', moedasData.mensagem);
            }
        } catch (error) {
            console.error('Erro na requisi√ß√£o para atualizar dados do usu√°rio:', error);
        }
    }
    loadUserData();
}

// üîπ Busca ranking completo no backend
async function fetchRanking() {
    try {
        const res = await fetch('https://meu-site4.onrender.com/api/ranking');
        rankingData = await res.json();
    } catch (err) {
        console.error("Erro ao buscar ranking:", err);
        rankingData = [];
    }
}

const usernameElement = document.getElementById('username');
const userAvatarElement = document.getElementById('user-avatar');
const userXpElement = document.getElementById('user-xp');
const rankingBody = document.getElementById('ranking-body');
const historyTableBody = document.getElementById('history-table-body');
const userBipsHomeElement = document.getElementById('user-bips-home');
const userRankHomeElement = document.getElementById('user-rank-home');
const homeRankingList = document.getElementById('home-ranking-list');

function loadUserData() {
    usernameElement.textContent = usuarioLogado.nome || "Usu√°rio";
    userAvatarElement.src = usuarioLogado.avatar || "https://via.placeholder.com/60";
    userXpElement.textContent = `${usuarioLogado.moedas || 0} BIP`;

    // ATUALIZA tamb√©m na home (linha abaixo √© a mudan√ßa principal)
    document.getElementById('nome-usuario-boasvindas').textContent = usuarioLogado.nome || "Usu√°rio";

    // Atualiza os dados na se√ß√£o "In√≠cio"
    userBipsHomeElement.textContent = usuarioLogado.moedas || 0;
    updateAvatarBorder(usuarioLogado.moedas || 0);

    // Pega ranking global do backend para calcular posi√ß√£o do usu√°rio
    fetchRanking().then(() => {
        rankingData.sort((a, b) => b.bip - a.bip);
        const userRankIndex = rankingData.findIndex(user => user.id === usuarioLogado.id);
        if (userRankIndex !== -1) {
            userRankHomeElement.textContent = `#${userRankIndex + 1}`;
        } else {
            userRankHomeElement.textContent = '--';
        }

        // Carrega o top 3 na home
        loadHomeRanking();
    });

    // MOSTRA OU ESCONDE O MENU GEST√ÉO
    if (usuarioLogado.tipoUsuario === "gestor") {
        document.getElementById('nav-gestao').style.display = 'block'; // mostra para gestor
    } else {
        document.getElementById('nav-gestao').style.display = 'none';  // esconde para colaborador
    }
}

function updateAvatarBorder(bips) {
    const avatarContainer = document.getElementById("avatar-container");
    avatarContainer.className = "avatar"; // limpa classes antigas

    if (bips >= 100) {
        avatarContainer.classList.add("borda-lendaria");
    } else if (bips >= 50) {
        avatarContainer.classList.add("borda-ouro");
    } else if (bips >= 20) {
        avatarContainer.classList.add("borda-prata");
    } else if (bips >= 5) {
        avatarContainer.classList.add("borda-bronze");
    } else {
        avatarContainer.classList.add("borda-padrao");
    }
}

// --- Renderiza Top 10 no cart√£o da Home (buscando direto no backend) ---
async function loadHomeTop10() {
  const listEl = document.getElementById('home-ranking-list');
  if (!listEl) return;

  // estado de carregamento
  listEl.innerHTML = '<li class="home-ranking-empty">Carregando ranking...</li>';

  try {
    // Tente endpoint espec√≠fico /top10 (mais eficiente)
    const endpointTop10 = 'https://meu-site4.onrender.com/api/ranking/top10';
    let top10 = null;

    try {
      const resTop10 = await fetch(endpointTop10, { cache: 'no-store' });
      if (resTop10.ok) {
        const data = await resTop10.json();
        // Se o backend retornar objeto com { top10: [...] } ajuste conforme
        top10 = Array.isArray(data) ? data : (Array.isArray(data.top10) ? data.top10 : null);
      } else {
        // se o endpoint n√£o existir/retornar 404/500, iremos ao fallback
        console.warn('endpoint /top10 retornou status', resTop10.status);
      }
    } catch (errTop10) {
      console.warn('Falha ao chamar /top10, fallback para /ranking:', errTop10);
      top10 = null;
    }

    // Fallback: buscar ranking completo e ordenar localmente
    if (!Array.isArray(top10)) {
      const resAll = await fetch('https://meu-site4.onrender.com/api/ranking', { cache: 'no-store' });
      if (!resAll.ok) throw new Error('Erro ao buscar ranking completo: ' + resAll.status);
      const all = await resAll.json();
      const arr = Array.isArray(all) ? all : (Array.isArray(all.ranking) ? all.ranking : []);
      arr.sort((a, b) => (b.bip || 0) - (a.bip || 0));
      top10 = arr.slice(0, 10);
    }

    // Se ainda n√£o h√° dados
    if (!Array.isArray(top10) || top10.length === 0) {
      listEl.innerHTML = '<li class="home-ranking-empty">Nenhum dado dispon√≠vel.</li>';
      return;
    }

    // Renderizar
    listEl.innerHTML = '';
    top10.forEach((user, idx) => {
      const li = document.createElement('li');
      li.className = 'home-ranking-item';

      const avatar = user.avatar || 'https://via.placeholder.com/40';
      // destaque do usu√°rio logado (opcional)
      const isMe = (typeof usuarioLogado !== 'undefined' && usuarioLogado && user.id && usuarioLogado.id && user.id === usuarioLogado.id);

      li.innerHTML = `
        <div class="rank-num">${idx + 1}</div>
        <img class="rank-avatar" src="${avatar}" alt="${(user.nome || 'Usu√°rio')}">
        <div class="rank-name">${user.nome || 'Usu√°rio'}</div>
        <div class="rank-bip">${(user.bip ?? 0)} BIP</div>
      `;

      if (isMe) {
        li.style.boxShadow = 'inset 0 0 0 2px rgba(67,230,139,0.08)';
        li.style.borderRadius = '8px';
      }

      listEl.appendChild(li);
    });
  } catch (err) {
    console.error('Erro ao carregar top10:', err);
    listEl.innerHTML = '<li class="home-ranking-empty">Erro ao carregar ranking.</li>';
  }
}

// Conectar bot√£o de refresh de forma segura
(function setupHomeTop10Refresh() {
  const btn = document.getElementById('home-top10-refresh');
  if (!btn) return;
  let busy = false;
  btn.addEventListener('click', async (e) => {
    if (busy) return;
    busy = true;
    try {
      btn.disabled = true;
      await loadHomeTop10();
    } finally {
      btn.disabled = false;
      busy = false;
    }
  });
})();

function showSection(sectionId) {
    // Oculta todas as sections
    const mainContentSections = document.querySelectorAll('.main-content > section');
    mainContentSections.forEach(section => {
        section.style.display = 'none';
    });

    // Mostra apenas a section selecionada
    const sectionToShow = document.getElementById(`${sectionId}-section`);
    if (sectionToShow) {
        sectionToShow.style.display = 'block';
    }

    // Atualiza o menu ativo
    document.querySelectorAll('.sidebar-nav .nav-icon').forEach(nav => nav.classList.remove('active'));
    document.querySelectorAll('.sidebar-nav .nav-icon').forEach(nav => {
        const span = nav.querySelector('span');
        if (
            span &&
            span.textContent.replace(/\s/g, '').toLowerCase() === sectionId.replace(/\s/g, '').toLowerCase()
        ) {
            nav.classList.add('active');
        }
    });

    // Fun√ß√µes espec√≠ficas
    if (sectionId === 'home') {
        loadUserData();
    } else if (sectionId === 'ranking') {
        updateRanking();
    } else if (sectionId === 'ponto') {
        updatePontoHistory();
    }
}

function toggleTopic(topicId) {
    const content = document.getElementById(topicId + '-content');
    const arrow = document.querySelector(`#${topicId} .topic-arrow`);
    
    content.classList.toggle('show');
    arrow.classList.toggle('rotate');
}

// üîπ Ranking global
async function updateRanking() {
    rankingBody.innerHTML = '';
    await fetchRanking(); // busca no backend
    rankingData.sort((a, b) => b.bip - a.bip);

    rankingData.forEach((user, index) => {
        const row = document.createElement('tr');
        if (index === 0) row.classList.add('position-1');
        if (index === 1) row.classList.add('position-2');
        if (index === 2) row.classList.add('position-3');

        let medal = '';
        if (index === 0) {
            medal = `<svg class="medal" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" fill="#FFD700"/>
                <circle cx="12" cy="12" r="8" fill="#FFEC8B"/>
                <text x="12" y="15" text-anchor="middle" font-size="8" font-weight="bold" fill="#8B7500">1¬∞</text>
            </svg>`;
        } else if (index === 1) {
            medal = `<svg class="medal" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" fill="#C0C0C0"/>
                <circle cx="12" cy="12" r="8" fill="#E6E6E6"/>
                <text x="12" y="15" text-anchor="middle" font-size="8" font-weight="bold" fill="#505050">2¬∞</text>
            </svg>`;
        } else if (index === 2) {
            medal = `<svg class="medal" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" fill="#CD7F32"/>
                <circle cx="12" cy="12" r="8" fill="#E6C39A"/>
                <text x="12" y="15" text-anchor="middle" font-size="8" font-weight="bold" fill="#5E3A00">3¬∞</text>
            </svg>`;
        }

        row.innerHTML = `
    <td>${index + 1} ${medal}</td>
    <td class="user-cell">
        <div class="avatar-container ${getBorderClass(user.bip)}">
            <img src="${user.avatar}" alt="${user.nome}" class="user-avatar">
        </div>
        ${user.nome}
    </td>
    <td class="xp-cell">
        <span class="xp-coins">${user.bip} BIP</span>
    </td>
`;
        rankingBody.appendChild(row);
    });
}

function getBorderClass(bips) {
    if (bips >= 200) return "borda-ouro";
    if (bips >= 100) return "borda-prata";
    if (bips >= 50) return "borda-bronze";
    return "borda-padrao";
}

function registrarPontosQuiz(pontosGanhos) {
  const usuarioId = sessionStorage.getItem("userId");
  fetch("https://meu-site4.onrender.com/api/pontos-extra", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ usuario_id: usuarioId, origem: "quiz", pontos: pontosGanhos })
  })
  .then(res => res.json())
  .then(data => {
    alert(data.mensagem);
  });
}

function registrarPontosQuiz(pontosGanhos) {
  const usuarioId = sessionStorage.getItem("userId");
  fetch("https://meu-site4.onrender.com/api/pontos-extra", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ usuario_id: usuarioId, origem: "fire", pontos: pontosGanhos })
  })
  .then(res => res.json())
  .then(data => {
    alert(data.mensagem);
  });
}

function registrarPontosQuiz(pontosGanhos) {
  const usuarioId = sessionStorage.getItem("userId");
  fetch("https://meu-site4.onrender.com/api/pontos-extra", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ usuario_id: usuarioId, origem: "memory", pontos: pontosGanhos })
  })
  .then(res => res.json())
  .then(data => {
    alert(data.mensagem);
  });
}

// üîπ Hist√≥rico de pontos continua igual
async function updatePontoHistory() {
    if (!usuarioLogado || !usuarioLogado.id) {
        historyTableBody.innerHTML = '<tr><td colspan="3" class="no-data">Por favor, fa√ßa login para ver o hist√≥rico.</td></tr>';
        return;
    }

    try {
        const res = await fetch(`https://meu-site4.onrender.com/api/pontos/${usuarioLogado.id}`);

        if (!res.ok) {
            if (res.status === 404) {
                historyTableBody.innerHTML = '<tr><td colspan="3" class="no-data">Nenhum ponto registrado para este usu√°rio.</td></tr>';
                return;
            }
            throw new Error(`HTTP error! status: ${res.status}`);
        }
        const data = await res.json();

        historyTableBody.innerHTML = '';
        if (data.pontos && data.pontos.length > 0) {
            data.pontos.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.data}</td>
                    <td>${record.hora}</td>
                    <td>${record.moedas}</td>
                `;
                historyTableBody.appendChild(row);
            });
        } else {
            const row = document.createElement('tr');
            row.innerHTML = `<td colspan="3" class="no-data">Nenhum ponto registrado.</td>`;
            historyTableBody.appendChild(row);
        }
    } catch (error) {
        console.error('Erro ao buscar hist√≥rico de pontos:', error);
        historyTableBody.innerHTML = `<tr><td colspan="3" class="no-data">Erro ao carregar dados. Tente novamente.</td></tr>`;
    }
}

// Recupera o id do usu√°rio logado (da URL ?user_id=... ou sessionStorage)
function getUserId() {
    const params = new URLSearchParams(window.location.search);
    return params.get("user_id") || sessionStorage.getItem("userId") || null;
}

// üîπ In√≠cio da p√°gina
window.onload = async function() {
  const avatarUpload = document.getElementById("avatar-upload");
  const userAvatarElement = document.getElementById("user-avatar");

  // Ao clicar na imagem do avatar, abre o seletor de arquivos
  userAvatarElement.addEventListener("click", function() {
    avatarUpload.click();
  });

  // Quando escolher uma imagem, faz upload
  avatarUpload.addEventListener("change", async function(event) {
    const file = event.target.files[0];
    if (file && usuarioLogado.id) {
      // Preview local imediato
      const reader = new FileReader();
      reader.onload = function(e) {
        userAvatarElement.src = e.target.result;
      };
      reader.readAsDataURL(file);

      // Envia para backend
      const formData = new FormData();
      formData.append('avatar', file);
      formData.append('usuario_id', usuarioLogado.id);

      try {
        const res = await fetch('https://meu-site4.onrender.com/api/upload-avatar', {
          method: 'POST',
          body: formData
        });
        const data = await res.json();
        if (data.status === "sucesso" && data.avatarUrl) {
          userAvatarElement.src = data.avatarUrl;
          usuarioLogado.avatar = data.avatarUrl;
          alert('Foto de perfil atualizada!');
        } else {
          alert('Erro ao enviar imagem: ' + (data.mensagem || 'Erro desconhecido'));
        }
      } catch (err) {
        alert('Erro ao fazer upload do avatar. Tente novamente.');
        console.error(err);
      }
    } else {
      alert("Selecione uma imagem e certifique-se que est√° logado.");
    }
  });

  // Buscar usu√°rio logado e atualizar a interface
  const userId = getUserId();
  if (userId) {
    await fetchUsuarioLogado(userId); // Busca dados do backend e preenche usuarioLogado
    await fetchAndUpdateUserData();   // Atualiza moedas/pontos e chama loadUserData()
  } else {
    // Redireciona para login se n√£o tiver ID salvo
    window.location.href = "login.html";
  }
};


// === PERFIL PROFISSIONAL INTERATIVO ===
// Requer que a section do perfil tenha id="profile-section"

document.addEventListener('DOMContentLoaded', function () {
  const profileSection = document.getElementById('profile-section');
  if (!profileSection) return;

  // ========== ELEMENTOS ==========
  const editBtn = profileSection.querySelector('.profile-edit-btn');
  const infoBlocks = profileSection.querySelectorAll('.profile-info-block');
  const tagsBlocks = profileSection.querySelectorAll('.profile-card .profile-tags');
  const interessesBlock = tagsBlocks[tagsBlocks.length - 1]; // Assume √∫ltimo bloco = interesses
  const certList = profileSection.querySelector('.profile-cert-list');
  const certUploadForm = profileSection.querySelector('.cert-upload-form');
  const certInput = profileSection.querySelector('#cert-upload-input');

  // ========== ESTADO ==========
  let isEditing = false;

  // ========== MODO EDI√á√ÉO ==========
  editBtn.addEventListener('click', function () {
    if (!isEditing) {
      ativarEdicao();
    } else {
      salvarEdicao();
    }
  });

  function ativarEdicao() {
    isEditing = true;
    editBtn.textContent = 'Salvar';
    editBtn.classList.add('salvar');

    // Torna campos edit√°veis
    infoBlocks.forEach(block => {
      const valueSpan = block.querySelector('.profile-value');
      const valor = valueSpan.textContent;
      const input = document.createElement('input');
      input.type = 'text';
      input.value = valor;
      input.className = 'profile-input-edit';
      valueSpan.replaceWith(input);
    });

    // Permite adicionar/remover tags de compet√™ncias
    tagsBlocks.forEach(tags => {
      // Adiciona bot√£o de remover em cada tag
      tags.querySelectorAll('.tag').forEach(tag => {
        if (!tag.querySelector('.remove-tag')) {
          const btn = document.createElement('span');
          btn.textContent = ' √ó';
          btn.className = 'remove-tag';
          btn.style.cursor = 'pointer';
          btn.style.color = '#f87171';
          btn.title = 'Remover';
          btn.onclick = () => tag.remove();
          tag.appendChild(btn);
        }
      });

      // Campo para adicionar nova tag
      if (!tags.querySelector('.add-tag-form')) {
        const addForm = document.createElement('form');
        addForm.className = 'add-tag-form';
        addForm.style.display = 'inline';
        addForm.innerHTML = `
          <input type="text" placeholder="Nova tag" class="tag-input" maxlength="25" style="margin-left:8px;padding:2px 6px;border-radius:7px;border:none;font-size:0.99rem;">
          <button type="submit" style="margin-left:4px;padding:2px 12px;border-radius:7px;background:#38cfa1;color:#181f2c;font-weight:bold;border:none;cursor:pointer;">Adicionar</button>
        `;
        addForm.onsubmit = (e) => {
          e.preventDefault();
          const val = addForm.querySelector('.tag-input').value.trim();
          if (val) {
            const nTag = document.createElement('span');
            nTag.className = 'tag';
            nTag.textContent = val;
            tags.appendChild(nTag);
            addForm.querySelector('.tag-input').value = '';
            // Adiciona bot√£o de remover
            const btn = document.createElement('span');
            btn.textContent = ' √ó';
            btn.className = 'remove-tag';
            btn.style.cursor = 'pointer';
            btn.style.color = '#f87171';
            btn.title = 'Remover';
            btn.onclick = () => nTag.remove();
            nTag.appendChild(btn);
          }
        };
        tags.appendChild(addForm);
      }
    });

    // Permite upload de certificado, altera bot√µes
    certList.querySelectorAll('.cert-upload-btn').forEach(btn => {
      btn.disabled = false;
      btn.onclick = (e) => {
        e.preventDefault();
        certInput.click();
        // Salva refer√™ncia para saber qual certificado est√° sendo atualizado
        certInput.dataset.certIndex = Array.from(certList.children).indexOf(btn.parentElement);
      };
    });
    certInput.disabled = false;

    // Adiciona bot√£o cancelar
    if (!profileSection.querySelector('.profile-cancel-btn')) {
      const cancelBtn = document.createElement('button');
      cancelBtn.textContent = 'Cancelar';
      cancelBtn.className = 'profile-cancel-btn';
      cancelBtn.style.marginLeft = '18px';
      cancelBtn.style.background = '#b51414';
      cancelBtn.style.color = '#fff';
      cancelBtn.style.borderRadius = '10px';
      cancelBtn.style.padding = '10px 24px';
      cancelBtn.style.fontSize = '1.09rem';
      cancelBtn.onclick = cancelarEdicao;
      editBtn.parentElement.appendChild(cancelBtn);
    }
  }

  function salvarEdicao() {
    // Salva campos edit√°veis
    infoBlocks.forEach(block => {
      const input = block.querySelector('input.profile-input-edit');
      if (input) {
        const span = document.createElement('span');
        span.className = 'profile-value';
        span.textContent = input.value || '---';
        input.replaceWith(span);
      }
    });

    // Remove bot√µes de remover/adicionar tags
    tagsBlocks.forEach(tags => {
      tags.querySelectorAll('.remove-tag').forEach(btn => btn.remove());
      tags.querySelectorAll('.add-tag-form').forEach(form => form.remove());
    });

    // Desabilita upload dos certificados
    certList.querySelectorAll('.cert-upload-btn').forEach(btn => {
      btn.disabled = true;
      btn.onclick = null;
    });
    certInput.disabled = true;

    // Remove bot√£o cancelar
    const cancelBtn = profileSection.querySelector('.profile-cancel-btn');
    if (cancelBtn) cancelBtn.remove();

    editBtn.textContent = 'Editar';
    editBtn.classList.remove('salvar');
    isEditing = false;
  }

  function cancelarEdicao() {
    // Apenas recarrega a p√°gina (ou voc√™ pode restaurar os valores antigos se preferir)
    window.location.reload();
  }

  // ========== UPLOAD DE CERTIFICADO ==========
  certUploadForm.addEventListener('submit', function (e) {
    e.preventDefault();
    if (!isEditing) return;
    certInput.click();
  });

  certInput.addEventListener('change', function (e) {
    if (!isEditing) return;
    const file = e.target.files[0];
    if (file) {
      // Aqui voc√™ faria o upload para o backend.
      // Vou apenas simular que fez upload e dar feedback.
      const idx = certInput.dataset.certIndex || 0;
      const certItem = certList.children[idx];
      if (certItem) {
        certItem.querySelector('span').textContent += ' (PDF enviado)';
        certItem.querySelector('.cert-upload-btn').textContent = 'Enviado';
        certItem.querySelector('.cert-upload-btn').disabled = true;
      }
      certInput.value = '';
      alert('Arquivo enviado! (simula√ß√£o)');
    }
  });

  // Por padr√£o, desabilita upload dos certificados
  certList.querySelectorAll('.cert-upload-btn').forEach(btn => btn.disabled = true);
  certInput.disabled = true;
});

// === JS para o Section "Games & Aprendizado" (Saiba Mais) ===
// Recursos: filtro din√¢mico dos cards por categoria e status

document.addEventListener('DOMContentLoaded', function () {
  const learnSection = document.getElementById('learn-section');
  if (!learnSection) return;

  // Elementos dos filtros
  const [categoriaSelect, statusSelect] = learnSection.querySelectorAll('.learn-filters select');
  const cardsGrid = learnSection.querySelector('.learn-cards-grid');
  const cards = Array.from(cardsGrid.querySelectorAll('.learn-card'));

  // --- Filtro Din√¢mico ---
  categoriaSelect.addEventListener('change', filtrarCards);
  statusSelect.addEventListener('change', filtrarCards);

  function filtrarCards() {
    const categoriaFiltro = categoriaSelect.value;
    const statusFiltro = statusSelect.value;

    cards.forEach(card => {
      let mostrar = true;

      // Categoria (classe tipo: categoria-seguranca, categoria-inclusao, etc)
      if (categoriaFiltro !== 'Todas categorias') {
        mostrar = card.classList.contains('categoria-' + categoriaFiltro.toLowerCase());
      }
      // Status (Novo, Em andamento, Conclu√≠do)
      if (mostrar && statusFiltro !== 'Todos') {
        const statusDiv = card.querySelector('.card-status');
        if (!statusDiv) mostrar = false;
        else {
          let statusTxt = statusDiv.classList.contains('novo') ? 'Novo'
                        : statusDiv.classList.contains('andamento') ? 'Em andamento'
                        : statusDiv.classList.contains('concluido') ? 'Conclu√≠do'
                        : '';
          mostrar = (statusFiltro === statusTxt);
        }
      }

      card.style.display = mostrar ? '' : 'none';
    });
  }

  // --- Trilha de Progresso: exibe alerta sobre o tema ao clicar ---
  learnSection.querySelectorAll('.trail-btn').forEach(btn => {
    btn.addEventListener('click', function () {
      const tema = btn.parentElement.querySelector('.trail-title').textContent.replace('Progresso ', '');
      alert('Aqui voc√™ pode ver mais sobre a trilha de: ' + tema + ' (funcionalidade futura)');
    });
  });

  // --- Cards "Jogar": para os cards sem link direto, exibe alerta ---
  cards.forEach(card => {
    const jogarBtn = card.querySelector('.card-action');
    if (jogarBtn && !jogarBtn.hasAttribute('onclick')) {
      jogarBtn.addEventListener('click', function () {
        alert('Em breve este jogo estar√° dispon√≠vel!');
      });
    }
  });
});

// === JS para Quizzes Section ===
// Front-end din√¢mico: cat√°logo, editor e publica√ß√£o (modo local/mem√≥ria)

document.addEventListener('DOMContentLoaded', function () {
  const quizzesSection = document.getElementById('quizzes-section');
  if (!quizzesSection) return;

  // Estado local de quizzes
  let quizzes = [{
    title: "Sem t√≠tulo",
    category: "Seguran√ßa",
    questions: [],
    published: false
  }];
  let editingQuizIdx = 0;
  let editorStep = 1; // 1: Detalhes, 2: Perguntas, 3: Revis√£o

  // === Elementos ===
  const btnNovoQuiz = quizzesSection.querySelector('.quiz-btn-green');
  const btnExportar = quizzesSection.querySelector('.quizzes-header-actions .quiz-btn:not(.quiz-btn-green)');
  const catalog = quizzesSection.querySelector('.quiz-catalog');
  const editor = quizzesSection.querySelector('.quiz-editor');
  const quizTitleInput = editor.querySelector('#quiz-title');
  const quizCategorySelect = editor.querySelector('#quiz-category');
  const perguntasDiv = editor.querySelector('.quiz-editor-perguntas');
  const perguntasTitle = perguntasDiv.querySelector('.quiz-editor-perguntas-title');
  const perguntasActions = perguntasDiv.querySelectorAll('button');
  const btnAddPergunta = perguntasActions[0];
  const btnIrRevisao = perguntasActions[1];
  const reviewList = editor.querySelector('.quiz-review-list');
  const btnSalvarRascunho = editor.querySelector('.quiz-editor-actions .quiz-btn:not(.quiz-btn-green)');
  const btnPublicar = editor.querySelector('.quiz-editor-actions .quiz-btn.quiz-btn-green');
  const publishedList = quizzesSection.querySelector('.quizzes-published-list');
  const publishedSearch = quizzesSection.querySelector('.quizzes-published-actions input');

  // === Renderiza√ß√£o ===
  function renderCatalog() {
    catalog.querySelectorAll('.quiz-catalog-card').forEach(c => c.remove());
    quizzes.forEach((q, idx) => {
      if (!q.published) {
        const card = document.createElement('div');
        card.className = 'quiz-catalog-card';
        card.innerHTML = `
          <div>
            <div class="quiz-catalog-card-title">${q.title || '(Sem t√≠tulo)'}</div>
            <div class="quiz-catalog-card-sub">${q.category} ‚Ä¢ ${q.questions.length} perg.</div>
          </div>
          <div class="quiz-catalog-card-actions">
            <button class="quiz-btn quiz-btn-small" data-edit="${idx}">Editar</button>
            <button class="quiz-btn quiz-btn-small quiz-btn-danger" data-del="${idx}">Excluir</button>
          </div>
        `;
        card.querySelector('[data-edit]').onclick = () => editarQuiz(idx);
        card.querySelector('[data-del]').onclick = () => excluirQuiz(idx);
        catalog.appendChild(card);
      }
    });
  }

  function renderEditor() {
    const quiz = quizzes[editingQuizIdx];
    quizTitleInput.value = quiz.title;
    quizCategorySelect.value = quiz.category;
    // Render perguntas (simples)
    let perguntasHtml = '';
    quiz.questions.forEach((p, i) => {
      perguntasHtml += `<div style="margin-bottom:8px;">
        <b>P${i+1}:</b> ${p.text} (${p.options.length} alternativas)
        <button class="quiz-btn quiz-btn-mini" data-del-pergunta="${i}" style="margin-left:8px;">Remover</button>
      </div>`;
    });
    perguntasTitle.innerHTML = `Perguntas (${quiz.questions.length})`;
    if (perguntasDiv.querySelector('.perguntas-lista')) perguntasDiv.querySelector('.perguntas-lista').remove();
    const lista = document.createElement('div');
    lista.className = 'perguntas-lista';
    lista.innerHTML = perguntasHtml || '<span style="color:#b3b9c5;">Nenhuma pergunta adicionada.</span>';
    perguntasDiv.insertBefore(lista, perguntasDiv.children[1]);
    // Remover perguntas
    lista.querySelectorAll('[data-del-pergunta]').forEach(btn => {
      btn.onclick = () => {
        quiz.questions.splice(Number(btn.dataset.delPergunta), 1);
        renderEditor();  
      };
    });

    // Review feedback
    const checks = [
      quiz.title && quiz.title.length > 4,
      quiz.category,
      quiz.questions.length > 0,
      quiz.questions.every(q => q.options.length >= 2),
      quiz.questions.every(q => typeof q.correct === "number")
    ];
    reviewList.innerHTML = `
      <li class="${checks[0] ? "quiz-review-ok" : "quiz-review-alert"}">${checks[0] ? "‚úÖ" : "‚ö†Ô∏è"} Tem um t√≠tulo claro</li>
      <li class="${checks[1] ? "quiz-review-ok" : "quiz-review-alert"}">${checks[1] ? "‚úÖ" : "‚ö†Ô∏è"} Categoria selecionada</li>
      <li class="${checks[2] ? "quiz-review-ok" : "quiz-review-alert"}">${checks[2] ? "‚úÖ" : "‚ö†Ô∏è"} Possui ao menos 1 pergunta</li>
      <li class="${checks[3] ? "quiz-review-ok" : "quiz-review-alert"}">${checks[3] ? "‚úÖ" : "‚ö†Ô∏è"} Cada pergunta tem 2+ alternativas</li>
      <li class="${checks[4] ? "quiz-review-ok" : "quiz-review-alert"}">${checks[4] ? "‚úÖ" : "‚ö†Ô∏è"} Cada pergunta tem 1 resposta correta</li>
    `;
  }

  function renderPublished() {
    publishedList.innerHTML = '';
    const buscado = publishedSearch.value?.toLowerCase() || '';
    const pubs = quizzes.filter(q => q.published && (!buscado || q.title.toLowerCase().includes(buscado)));
    if (pubs.length === 0) {
      publishedList.innerHTML = `<span class="quizzes-published-empty">Nenhum quiz publicado</span>`;
      return;
    }
    pubs.forEach(q => {
      const div = document.createElement('div');
      div.className = "quiz-published-item";
      div.style.marginBottom = '8px';
      div.innerHTML = `<b>${q.title}</b> <span style="color:#67cdf7;">(${q.category})</span> - ${q.questions.length} perguntas`;
      publishedList.appendChild(div);
    });
  }

  // === A√ß√µes do Editor ===
  quizTitleInput.oninput = () => {
    quizzes[editingQuizIdx].title = quizTitleInput.value;
    renderCatalog();
    renderEditor();
  };
  quizCategorySelect.onchange = () => {
    quizzes[editingQuizIdx].category = quizCategorySelect.value;
    renderCatalog();
    renderEditor();
  };

  btnAddPergunta.onclick = () => {
    // Simples: prompt para pergunta e alternativas
    const texto = prompt("Digite a pergunta:");
    if (!texto) return;
    const op1 = prompt("Alternativa 1:");
    const op2 = prompt("Alternativa 2:");
    if (!op1 || !op2) { alert('Precisa de pelo menos 2 alternativas!'); return; }
    const op3 = prompt("Alternativa 3 (opcional):");
    const alternativas = [op1, op2];
    if (op3) alternativas.push(op3);
    const correta = prompt("N√∫mero da alternativa correta (1, 2 ou 3):");
    let corretaIdx = Number(correta) - 1;
    if (isNaN(corretaIdx) || corretaIdx < 0 || corretaIdx >= alternativas.length) {
      alert('Informe o n√∫mero da alternativa correta!');
      return;
    }
    quizzes[editingQuizIdx].questions.push({
      text: texto,
      options: alternativas,
      correct: corretaIdx
    });
    renderEditor();
  };

  btnIrRevisao.onclick = () => {
    editorStep = 3;
    alert("Modo revis√£o ativado! (Simula√ß√£o, n√£o bloqueia campos)");
  };

  btnSalvarRascunho.onclick = () => {
    alert("Rascunho salvo localmente!");
    renderCatalog();
    renderPublished();
  };

  btnPublicar.onclick = () => {
    quizzes[editingQuizIdx].published = true;
    alert("Quiz publicado!");
    renderCatalog();
    renderPublished();
  };

  // === Novo Quiz ===
  btnNovoQuiz.onclick = () => {
    quizzes.push({
      title: "Novo Quiz",
      category: "Seguran√ßa",
      questions: [],
      published: false
    });
    editingQuizIdx = quizzes.length - 1;
    renderCatalog();
    renderEditor();
  };

  // === Exportar (simples) ===
  btnExportar.onclick = () => {
    const txt = JSON.stringify(quizzes, null, 2);
    const blob = new Blob([txt], {type: "application/json"});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = "quizzes.json";
    a.click();
  };

  // === Editar/Excluir Quiz ===
  function editarQuiz(idx) {
    editingQuizIdx = idx;
    renderEditor();
  }
  function excluirQuiz(idx) {
    if (confirm("Excluir este quiz?")) {
      quizzes.splice(idx, 1);
      editingQuizIdx = 0;
      renderCatalog();
      renderEditor();
      renderPublished();
    }
  }

  // === Busca em quizzes publicados ===
  publishedSearch.oninput = renderPublished;

  // === Inicializa√ß√£o ===
  renderCatalog();
  renderEditor();
  renderPublished();
});

// === JS para a Loja de Recompensas ===
// Troca de abas (Vouchers, Benef√≠cios, Produtos) e a√ß√£o do bot√£o "Resgatar"

document.addEventListener('DOMContentLoaded', function () {
  const storeSection = document.getElementById('store-section');
  if (!storeSection) return;

  // Abas da loja
  const tabBtns = storeSection.querySelectorAll('.loja-tab-btn');
  const tabContents = storeSection.querySelectorAll('.loja-tab-content');

  tabBtns.forEach(btn => {
    btn.addEventListener('click', function () {
      // Ativa s√≥ o bot√£o clicado
      tabBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Mostra s√≥ a tab clicada
      tabContents.forEach(tc => tc.style.display = 'none');
      const tab = btn.getAttribute('data-tab');
      const showTab = storeSection.querySelector(`#loja-tab-${tab}`);
      if (showTab) showTab.style.display = 'flex';
    });
  });

  // A√ß√£o dos bot√µes "Resgatar"
  storeSection.querySelectorAll('.loja-card-btn').forEach(btn => {
    btn.addEventListener('click', function () {
      const card = btn.closest('.loja-card');
      const nome = card.querySelector('.loja-card-title').textContent;
      const pontos = card.querySelector('.loja-card-points').textContent;
      // Aqui voc√™ pode integrar com backend para debitar pontos e registrar resgate
      alert(`Voc√™ solicitou o resgate de: ${nome} (${pontos})\n\nFuncionalidade de resgate pode ser integrada ao backend!`);
    });
  });

  // Exibe a primeira aba como padr√£o ao carregar
  tabBtns[0].click();
});

    </script>
    <!-- Biblioteca de √≠cones Lucide -->
<script src="https://unpkg.com/lucide@latest"></script>
<script>
  lucide.createIcons(); // Ativa os √≠cones
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const sidebar = document.querySelector(".sidebar");
  const backdrop = document.querySelector(".sidebar-backdrop");
  const toggle = document.getElementById("sidebar-toggle");

  // Se os elementos existirem
  if (sidebar && backdrop && toggle) {
    // Quando clicar no bot√£o hamb√∫rguer
    toggle.addEventListener("click", () => {
      const isOpen = sidebar.classList.toggle("open");
      backdrop.style.display = isOpen ? "block" : "none";
      document.body.style.overflow = isOpen ? "hidden" : ""; // trava scroll quando menu aberto
    });

    // Quando clicar fora do menu (no fundo escuro)
    backdrop.addEventListener("click", () => {
      sidebar.classList.remove("open");
      backdrop.style.display = "none";
      document.body.style.overflow = "";
    });
  }
});

// public/js/show-gestao.js
// Mostra/oculta o bot√£o "Gest√£o" conforme tipoUsuario do usu√°rio logado.
// - Usa window.usuarioLogado se j√° existir.
// - Se n√£o existir, faz fetch /api/usuario-logado/:id usando user_id da query ou sessionStorage.
// - Exp√µe window.updateGestaoVisibility() para permitir chamadas manuais.

(function () {
  async function fetchTipoUsuarioById(userId) {
    try {
      const res = await fetch(`/api/usuario-logado/${encodeURIComponent(userId)}`);
      if (!res.ok) return null;
      const data = await res.json();
      return data && data.usuario && data.usuario.tipoUsuario ? data.usuario.tipoUsuario : null;
    } catch (err) {
      console.error('Erro ao buscar tipoUsuario:', err);
      return null;
    }
  }

  async function updateGestaoVisibility() {
    const navGestao = document.getElementById('nav-gestao');
    if (!navGestao) return;

    // Esconde por padr√£o para evitar flash
    navGestao.style.display = 'none';

    try {
      // Se existe objeto global j√° carregado use ele (mais r√°pido)
      if (window.usuarioLogado && typeof window.usuarioLogado.tipoUsuario !== 'undefined') {
        const tipo = window.usuarioLogado.tipoUsuario;
        console.log('updateGestaoVisibility (from usuarioLogado):', tipo);
        if (tipo === 'gestor') navGestao.style.display = '';
        else navGestao.style.display = 'none';
        return;
      }

      // Fallback: tenta obter userId e buscar no backend
      const params = new URLSearchParams(window.location.search);
      const userId = params.get('user_id') || sessionStorage.getItem('userId');
      if (!userId) {
        // sem id, mant√©m oculto
        navGestao.style.display = 'none';
        return;
      }

      const tipoFetch = await fetchTipoUsuarioById(userId);
      console.log('updateGestaoVisibility (fetch):', tipoFetch);
      if (tipoFetch === 'gestor') navGestao.style.display = '';
      else navGestao.style.display = 'none';
    } catch (err) {
      console.error('updateGestaoVisibility erro:', err);
      navGestao.style.display = 'none';
    }
  }

  // Exponha para uso manual (p.ex. chamar depois de login)
  window.updateGestaoVisibility = updateGestaoVisibility;

  // Chame ao DOMContentLoaded (com pequeno delay para evitar race conditions)
  document.addEventListener('DOMContentLoaded', function () {
    setTimeout(updateGestaoVisibility, 50);
  });
})();
</script>
</body>
</html>
